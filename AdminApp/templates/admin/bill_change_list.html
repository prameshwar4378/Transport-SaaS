{% extends "admin/change_list.html" %}
{% load static %}

{% block extrahead %}
{{ block.super }}
<style>
    .print-btn {
        background: #28a745;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 4px 8px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
    }
    
    .print-btn:hover {
        background: #218838;
        transform: scale(1.1);
    }
    
    .print-btn:active {
        transform: scale(0.95);
    }
</style>

<script>
// Print individual bill
function printBill(billId) {
    // Open print page in new window
    const printUrl = `{% url 'bill_print' 0 %}`.replace('0', billId);
    const printWindow = window.open(printUrl, '_blank', 'width=800,height=600');
    
    // Focus the new window
    if (printWindow) {
        printWindow.focus();
    }
}

// Auto-print after save if needed
document.addEventListener('DOMContentLoaded', function() {
    // Check URL for auto-print parameter
    const urlParams = new URLSearchParams(window.location.search);
    const autoPrintId = urlParams.get('_print');
    
    if (autoPrintId) {
        setTimeout(() => {
            printBill(autoPrintId);
            // Clean URL
            const newUrl = window.location.pathname + window.location.search.replace('&_print=' + autoPrintId, '').replace('?_print=' + autoPrintId, '');
            window.history.replaceState({}, document.title, newUrl);
        }, 1000);
    }
});
</script>
{% endblock %}
